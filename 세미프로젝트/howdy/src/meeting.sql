DROP TABLE MEETING
CASCADE CONSTRAINTS;

DROP SEQUENCE SEQ_MEETING;

ALTER TABLE MEETING DROP CONSTRAINT FK_MEETING_SEQ;


CREATE TABLE MEETING(
    MEETING_SEQ NUMBER(5) PRIMARY KEY,
    GROUPS_SEQ NUMBER(5) NOT NULL,
    CATEGORY VARCHAR2(100) NOT NULL,
    LOCATION VARCHAR2(100) NOT NULL,
    SDATE VARCHAR2(12) NOT NULL,
    EDATE VARCHAR2(12) NOT NULL,
    RDATE DATE NOT NULL,
    TITLE VARCHAR2(200) NOT NULL,
    CONTENT VARCHAR2(4000),
    MAX_MEM NUMBER(10) NOT NULL,
    DEL NUMBER(1) NOT NULL,
    LATITUDE VARCHAR2(100) NOT NULL,
    LONGITUDE VARCHAR2(100) NOT NULL
);

CREATE SEQUENCE SEQ_MEETING
START WITH 1
INCREMENT BY 1;

ALTER TABLE MEETING
ADD CONSTRAINT FK_MEETING_SEQ FOREIGN KEY(GROUPS_SEQ)
REFERENCES GROUPS(GROUPS_SEQ);

SELECT * FROM  MEETING;

SELECT MEETING_SEQ, GROUPS_SEQ, CATEGORY, LOCATION, SDATE, EDATE, RDATE, TITLE, CONTENT, MAX_MEM, DEL, LATITUDE, LONGITUDE
FROM MEETING
WHERE GROUPS_SEQ IN (SELECT GROUPS_SEQ
						FROM GROUPS
						WHERE CATEGORY= 'sports');

SELECT MEETING_SEQ, GROUPS_SEQ, CATEGORY, LOCATION, SDATE, EDATE, RDATE, TITLE,  CONTENT, MAX_MEM, DEL, LATITUDE, LONGITUDE
FROM MEETING 
WHERE SDATE BETWEEN '20210701%' AND '20210731%'

SELECT MEETING_SEQ, GROUPS_SEQ, CATEGORY, LOCATION, SDATE, EDATE, RDATE, TITLE, CONTENT, MAX_MEM, DEL, LATITUDE, LONGITUDE
FROM (SELECT ROW_NUMBER()OVER(PARTITION BY SDATE ORDER BY SDATE ASC) AS RNUM,
	  MEETING_SEQ, GROUPS_SEQ, CATEGORY, LOCATION, SDATE, EDATE, RDATE, TITLE, CONTENT, MAX_MEM, DEL, LATITUDE, LONGITUDE
	  FROM MEETING
	  WHERE SUBSTR(SDATE,1,6)=?
	  	AND MEETING_SEQ IN(SELECT MEETING_SEQ
	  						FROM MEETING_MEM
	  						WHERE ID=?))
WHERE RNUM BETWEEN 1 AND 5;